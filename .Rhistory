"Min Score" = min(Score), "Max Score" = max(Score), "Avg Score" = mean(Score),"Median Score" = median(as.numeric(Score))),
summarise(group_by(filter(aFinal, Score < 100), Keyword, Match.type), "Num Incomplete Registrations" = n()),
by = c("Keyword", "Match.type")
)
aFinal_final <- select(aFinal_agg,c(1,2,3,4,5,6,7,8,9,10,11,16,12,13,14,15))
testDF <- data.frame(v1 = sample(1:1000, 50), v2 = rnorm(50)), v3 = rep(letters[1:25], 2))
letters
letters(25)
letters[1:25]
testDF <- data.frame(v1 = sample(1:1000, 50), v2 = rnorm(50), v3 = rep(letters[1:25], 2))
View(testDF)
testDF <- data.frame(v1 = sample(1:1000, 50), v2 = rnorm(50), v3 = rep(letters[1:10], 5))
replace(testDF, filter(testDF, v3 == "a", "bbb"))
replace(testDF, filter(testDF, v3 == "a"), "bbb")
filter(testDF, v3 == "a")
replace(testDF, testDF$v3 == "a", "bbb")
testDF$v3 == "a"
replace(testDF$v3, testDF$v3 == "a", "bbb")
testDF <- data.frame(v1 = sample(1:1000, 50), v2 = rnorm(50), v3 = rep(letters[1:10], 5))
replace(testDF$v3, testDF$v3 == "a", 10)
testDF <- data.frame(v1 = sample(1:1000, 50), v2 = rnorm(50), v3 = rep(letters[1:10], 5))
replace(testDF$v1, testDF$v1 >500, 1000)
dor()
dir()
affiliate_raw1 <- read.csv("150630 - affiliate2.06302015.csv", stringsAsFactors = FALSE)
affiliate_raw2 <- read.csv("150706 - affiliate2.07062015.csv", stringsAsFactors = FALSE)
head(affiliate_raw1)
str(affiliate_raw1)
affiliate_raw1 <- select(affiliate_raw1, c(2, 4, 5, 8, 12, 15, 20))
affiliate_raw2 <- select(affiliate_raw2, c(2, 4, 5, 8, 12, 15, 20))
affiliate_raw1 <- transform(affiliate_raw1, Date = mdy_hms(Date))
library(lubridate)
affiliate_raw1 <- transform(affiliate_raw1, Date = mdy_hms(Date))
affiliate_raw2 <- transform(affiliate_raw2, Date = mdy_hms(Date))
min(affiliate_raw1$Date)
max(affiliate_raw1$Date)
nrow(affiliate_raw1$Date > mdy("06/28/15"))
class(affiliate_raw1$Date)
mdy("06/28/15"))
mdy("06/28/15")
nrow(affiliate_raw1$Date > mdy_hms("06/28/15 00:00:01 UTC"))
nrow(affiliate_raw1$Date > mdy_hms("06/28/15 23:59:59 UTC"))
length(affiliate_raw1$Date > mdy_hms("06/28/15 23:59:59 UTC"))
length(affiliate_raw1$Date < mdy_hms("06/28/15 23:59:59 UTC"))
length(affiliate_raw1$Date)
head(affiliate_raw1$Date > mdy_hms("06/28/15 23:59:59 UTC"))
sum(affiliate_raw1$Date > mdy_hms("06/28/15 23:59:59 UTC"))
sum(affiliate_raw1$Date < mdy_hms("06/28/15 23:59:59 UTC"))
affiliate_raw1 <- filter(affiliate_raw1, Date > mdy_hms("06/28/15 23:59:59 UTC"))
affiliate_raw <- rbind(affiliate_raw1, affiliate_raw2)
affiliate$Avg.CreditScore[is.na(affiliate$Avg.CreditScore)] <- 0
affiliate <- rbind(affiliate_raw1, affiliate_raw2)
affiliate$Avg.CreditScore[is.na(affiliate$Avg.CreditScore)] <- 0
names(affiliate)
listAffliliates_pruned <- read.csv("listAffiliates_pruned.csv", stringsAsFactors = FALSE)[1:4]
affiliate_list <- inner_join(affiliate, listAffliliates_pruned, by = "Partner.Name")
affiliate_Score <- cbind(affiliate_list, ExpRev = rep(0, nrow(affiliate)))
for (i in 1:nrow(affiliate_Score)) {
j = 0
for (j in 1:5) {
if (affiliate_Score$Avg.CreditScore[i]>= ExpRev_clean$min_score[j]
& affiliate_Score$Avg.CreditScore[i] <= ExpRev_clean$max_score[j]) {
affiliate_Score$ExpRev[i] <- ExpRev_clean$expected_revenue[j]
}
}
}
affiliate_Score <- cbind(affiliate_list, ExpRev = rep(0, nrow(affiliate_list)))
for (i in 1:nrow(affiliate_Score)) {
j = 0
for (j in 1:5) {
if (affiliate_Score$Avg.CreditScore[i]>= ExpRev_clean$min_score[j]
& affiliate_Score$Avg.CreditScore[i] <= ExpRev_clean$max_score[j]) {
affiliate_Score$ExpRev[i] <- ExpRev_clean$expected_revenue[j]
}
}
}
length(affiliate_Score[affiliateScore[,6] >=100, 6])
length(affiliate_Score[affiliateScore[,8] > 0, 8]) ## Should match the number above
table(affiliate_Score$ExpRev) ## First number should be for ExpRev 0
length(affiliate_Score[affiliateScore[,6] <100, 6]) ## Should match the number above
length(affiliate_Score[affiliate_Score[,6] >=100, 6])
length(affiliate_Score[affiliate_Score[,8] > 0, 8]) ## Should match the number above
table(affiliate_Score$ExpRev) ## First number should be for ExpRev 0
length(affiliate_Score[affiliate_Score[,6] <100, 6]) ## Should match the number above
names(affiliate_Score)
length(affiliate_Score[affiliate_Score[,11] > 0, 11]) ## get the number of input where ExpRev has been changed (>0) -- Should match the number above
ftable(table(affiliateScore$Partner.Name, affiliateScore$ExpRev))
ftable(table(affiliate_Score$Partner.Name, affiliate_Score$ExpRev))
View(ExpRev_clean)
ExpRev2 <- read.csv("mktincent.csv", stringsAsFactors = FALSE)
ExpRev2_clean <- mutate(ExpRev2, min_score = as.numeric(substr(credit_band, 2,4)),
max_score = as.numeric(substr(credit_band, 6, 8)))
ExpRev2_clean[1,4] <- 850
ExpRev2 <- read.csv("mktincent.csv", stringsAsFactors = FALSE)
ExpRev2_clean <- mutate(ExpRev2, min_score = as.numeric(substr(cs_band, 2,4)),
max_score = as.numeric(substr(cs_band, 6, 8)))
ExpRev2_clean[1,4] <- 850
ExpRev2_clean
ExpRev2_clean <- mutate(ExpRev2, min_score = as.numeric(substr(cs_band, 2,4)),
max_score = as.numeric(substr(cs_band, 6, 8)))
ExpRev2_clean[1,5] <- 850
ExpRev2_clean
ExpRev2 <- read.csv("mktincent.csv", stringsAsFactors = FALSE)
ExpRev2_clean <- mutate(ExpRev2, min_score = as.numeric(substr(cs_band, 2,5)),
max_score = as.numeric(substr(cs_band, 6, 9)))
ExpRev2_clean[1,5] <- 850
ExpRev2_clean
ExpRev2 <- read.csv("mktincent.csv", stringsAsFactors = FALSE)
ExpRev2_clean <- mutate(ExpRev2, min_score = as.numeric(substr(cs_band, 2,4)),
max_score = as.numeric(substr(cs_band, 6, 9)))
ExpRev2_clean[1,5] <- 850
ExpRev2_clean
ExpRev2_clean[1,4] <- 100
ExpRev2_clean[1,5] <- 499
ExpRev2_clean
ExpRev2 <- read.csv("mktincent.csv", stringsAsFactors = FALSE)
ExpRev2_clean <- mutate(ExpRev2, min_score = as.numeric(substr(cs_band, 2,4)),
max_score = as.numeric(substr(cs_band, 6, 9)))
ExpRev2_clean[1,5] <- 850
ExpRev2_clean[5,4] <- 100
ExpRev2_clean[5,5] <- 499
ExpRev2_clean
ExpRev_clean
affiliate_Score <- bind_cols(affiliate_list, ExpRev = rep(0, nrow(affiliate_list)), ExpRev2 = rep(0, nrow(affiliate_list)))
affiliate_Score <- bind_cols(affiliate_list, ExpRev = as.data.frame(rep(0, nrow(affiliate_list))), ExpRev2 = as.data.frame(rep(0, nrow(affiliate_list))))
head(affiliate_Score)
names(affiliate_Score)
affiliate_Score <- bind_cols(affiliate_list, as.data.frame(ExpRev = rep(0, nrow(affiliate_list))),
as.data.frame(ExpRev2 = rep(0, nrow(affiliate_list))))
as.data.frame(ExpRev = rep(0, nrow(affiliate_list)))
data.frame(ExpRev = rep(0, nrow(affiliate_list)))
affiliate_Score <- bind_cols(affiliate_list, data.frame(ExpRev = rep(0, nrow(affiliate_list))),
data.frame(ExpRev2 = rep(0, nrow(affiliate_list))))
names(affiliate_Score)
listAffliliates_pruned
nrow(filter(affiliate_Score, Avg.CreditScore >= 100 & Avg.CreditScore <=499 & IncentType %in% "incent"))
ExpRev_clean
ExpRev2_clean
affiliate_Score_5i <- filter(affiliate_Score, Avg.CreditScore >= 100 & Avg.CreditScore <=499 & IncentType %in% "incent")
affiliate_Score_5n <- filter(affiliate_Score, Avg.CreditScore >= 100 & Avg.CreditScore <=499 & IncentType %in% "nonincent")
affiliate_Score_4i <- filter(affiliate_Score, Avg.CreditScore >= 500 & Avg.CreditScore <=574 & IncentType %in% "incent")
affiliate_Score_4n <- filter(affiliate_Score, Avg.CreditScore >= 500 & Avg.CreditScore <=574 & IncentType %in% "nonincent")
affiliate_Score_3i <- filter(affiliate_Score, Avg.CreditScore >= 575 & Avg.CreditScore <=674 & IncentType %in% "incent")
affiliate_Score_3n <- filter(affiliate_Score, Avg.CreditScore >= 575 & Avg.CreditScore <=674 & IncentType %in% "nonincent")
affiliate_Score_2i <- filter(affiliate_Score, Avg.CreditScore >= 675 & Avg.CreditScore <=749 & IncentType %in% "incent")
affiliate_Score_2n <- filter(affiliate_Score, Avg.CreditScore >= 675 & Avg.CreditScore <=749 & IncentType %in% "nonincent")
affiliate_Score_1i <- filter(affiliate_Score, Avg.CreditScore >= 750 & Avg.CreditScore <=850 & IncentType %in% "incent")
affiliate_Score_1n <- filter(affiliate_Score, Avg.CreditScore >= 750 & Avg.CreditScore <=850 & IncentType %in% "nonincent")
affiliate_Score_1i$ExpRev <- ExpRev_clean$expected_revenue[1]
affiliate_Score_1i$ExpRev2 <- ExpRev2_clean$incent[1]
affiliate_Score_1n$ExpRev <- ExpRev_clean$expected_revenue[1]
affiliate_Score_1n$ExpRev2 <- ExpRev2_clean$nonincent[1]
affiliate_Score_2i$ExpRev <- ExpRev_clean$expected_revenue[2]
affiliate_Score_2i$ExpRev2 <- ExpRev2_clean$incent[2]
affiliate_Score_2n$ExpRev <- ExpRev_clean$expected_revenue[2]
affiliate_Score_2n$ExpRev2 <- ExpRev2_clean$nonincent[2]
affiliate_Score_3i$ExpRev <- ExpRev_clean$expected_revenue[3]
affiliate_Score_3i$ExpRev2 <- ExpRev2_clean$incent[3]
affiliate_Score_3n$ExpRev <- ExpRev_clean$expected_revenue[3]
affiliate_Score_3n$ExpRev2 <- ExpRev2_clean$nonincent[3]
affiliate_Score_4i$ExpRev <- ExpRev_clean$expected_revenue[4]
affiliate_Score_4i$ExpRev2 <- ExpRev2_clean$incent[4]
affiliate_Score_4n$ExpRev <- ExpRev_clean$expected_revenue[4]
affiliate_Score_4n$ExpRev2 <- ExpRev2_clean$nonincent[4]
affiliate_Score_5i$ExpRev <- ExpRev_clean$expected_revenue[5]
affiliate_Score_5i$ExpRev2 <- ExpRev2_clean$incent[5]
affiliate_Score_5n$ExpRev <- ExpRev_clean$expected_revenue[5]
affiliate_Score_5n$ExpRev2 <- ExpRev2_clean$nonincent[5]
affiliate_Score <- bind_rows(affiliate_Score_1i, affiliate_Score_2i, affiliate_Score_3i, affiliate_Score_4i, affiliate_Score_5i)
table(affiliate_Score$ExpRev, affiliate_Score$IncentType)
table(affiliate_Score$ExpRev2, affiliate_Score$IncentType)
table(affiliate_Score$IncentType)
affiliate_list <- inner_join(affiliate, listAffliliates_pruned, by = "Partner.Name")
affiliate_Score <- bind_cols(affiliate_list, data.frame(ExpRev = rep(0, nrow(affiliate_list))),
data.frame(ExpRev2 = rep(0, nrow(affiliate_list))))
table(affiliate_Score$IncentType)
table(affiliate_Score$ExpRev, affiliate_Score$IncentType)
table(affiliate_Score$ExpRev2, affiliate_Score$IncentType)
affiliate_Score_5i <- filter(affiliate_Score, Avg.CreditScore >= 100 & Avg.CreditScore <=499 & IncentType %in% "incent")
affiliate_Score_5n <- filter(affiliate_Score, Avg.CreditScore >= 100 & Avg.CreditScore <=499 & IncentType %in% "nonincent")
affiliate_Score_4i <- filter(affiliate_Score, Avg.CreditScore >= 500 & Avg.CreditScore <=574 & IncentType %in% "incent")
affiliate_Score_4n <- filter(affiliate_Score, Avg.CreditScore >= 500 & Avg.CreditScore <=574 & IncentType %in% "nonincent")
affiliate_Score_3i <- filter(affiliate_Score, Avg.CreditScore >= 575 & Avg.CreditScore <=674 & IncentType %in% "incent")
affiliate_Score_3n <- filter(affiliate_Score, Avg.CreditScore >= 575 & Avg.CreditScore <=674 & IncentType %in% "nonincent")
affiliate_Score_2i <- filter(affiliate_Score, Avg.CreditScore >= 675 & Avg.CreditScore <=749 & IncentType %in% "incent")
affiliate_Score_2n <- filter(affiliate_Score, Avg.CreditScore >= 675 & Avg.CreditScore <=749 & IncentType %in% "nonincent")
affiliate_Score_1i <- filter(affiliate_Score, Avg.CreditScore >= 750 & Avg.CreditScore <=850 & IncentType %in% "incent")
affiliate_Score_1n <- filter(affiliate_Score, Avg.CreditScore >= 750 & Avg.CreditScore <=850 & IncentType %in% "nonincent")
affiliate_Score_1i$ExpRev <- ExpRev_clean$expected_revenue[1]
affiliate_Score_1i$ExpRev2 <- ExpRev2_clean$incent[1]
affiliate_Score_1n$ExpRev <- ExpRev_clean$expected_revenue[1]
affiliate_Score_1n$ExpRev2 <- ExpRev2_clean$nonincent[1]
affiliate_Score_2i$ExpRev <- ExpRev_clean$expected_revenue[2]
affiliate_Score_2i$ExpRev2 <- ExpRev2_clean$incent[2]
affiliate_Score_2n$ExpRev <- ExpRev_clean$expected_revenue[2]
affiliate_Score_2n$ExpRev2 <- ExpRev2_clean$nonincent[2]
affiliate_Score_3i$ExpRev <- ExpRev_clean$expected_revenue[3]
affiliate_Score_3i$ExpRev2 <- ExpRev2_clean$incent[3]
affiliate_Score_3n$ExpRev <- ExpRev_clean$expected_revenue[3]
affiliate_Score_3n$ExpRev2 <- ExpRev2_clean$nonincent[3]
affiliate_Score_4i$ExpRev <- ExpRev_clean$expected_revenue[4]
affiliate_Score_4i$ExpRev2 <- ExpRev2_clean$incent[4]
affiliate_Score_4n$ExpRev <- ExpRev_clean$expected_revenue[4]
affiliate_Score_4n$ExpRev2 <- ExpRev2_clean$nonincent[4]
affiliate_Score_5i$ExpRev <- ExpRev_clean$expected_revenue[5]
affiliate_Score_5i$ExpRev2 <- ExpRev2_clean$incent[5]
affiliate_Score_5n$ExpRev <- ExpRev_clean$expected_revenue[5]
affiliate_Score_5n$ExpRev2 <- ExpRev2_clean$nonincent[5]
affiliate_Score <- bind_rows(affiliate_Score_1i, affiliate_Score_2i, affiliate_Score_3i, affiliate_Score_4i, affiliate_Score_5i)
table(affiliate_Score$IncentType)
table(affiliate_Score$ExpRev, affiliate_Score$IncentType)
table(affiliate_Score$ExpRev2, affiliate_Score$IncentType)
affiliate_Score <- bind_cols(affiliate_list, data.frame(ExpRev = rep(0, nrow(affiliate_list))),
data.frame(ExpRev2 = rep(0, nrow(affiliate_list))))
affiliate_Score_5i <- filter(affiliate_Score, Avg.CreditScore >= 100 & Avg.CreditScore <=499 & IncentType %in% "incent")
affiliate_Score_5n <- filter(affiliate_Score, Avg.CreditScore >= 100 & Avg.CreditScore <=499 & IncentType %in% "nonincent")
affiliate_Score_4i <- filter(affiliate_Score, Avg.CreditScore >= 500 & Avg.CreditScore <=574 & IncentType %in% "incent")
affiliate_Score_4n <- filter(affiliate_Score, Avg.CreditScore >= 500 & Avg.CreditScore <=574 & IncentType %in% "nonincent")
affiliate_Score_3i <- filter(affiliate_Score, Avg.CreditScore >= 575 & Avg.CreditScore <=674 & IncentType %in% "incent")
affiliate_Score_3n <- filter(affiliate_Score, Avg.CreditScore >= 575 & Avg.CreditScore <=674 & IncentType %in% "nonincent")
affiliate_Score_2i <- filter(affiliate_Score, Avg.CreditScore >= 675 & Avg.CreditScore <=749 & IncentType %in% "incent")
affiliate_Score_2n <- filter(affiliate_Score, Avg.CreditScore >= 675 & Avg.CreditScore <=749 & IncentType %in% "nonincent")
affiliate_Score_1i <- filter(affiliate_Score, Avg.CreditScore >= 750 & Avg.CreditScore <=850 & IncentType %in% "incent")
affiliate_Score_1n <- filter(affiliate_Score, Avg.CreditScore >= 750 & Avg.CreditScore <=850 & IncentType %in% "nonincent")
affiliate_Score0 <- filter(affiliate_Score, Avg.CreditScore <100)
affiliate_Score_1i$ExpRev <- ExpRev_clean$expected_revenue[1]
affiliate_Score_1i$ExpRev2 <- ExpRev2_clean$incent[1]
affiliate_Score_1n$ExpRev <- ExpRev_clean$expected_revenue[1]
affiliate_Score_1n$ExpRev2 <- ExpRev2_clean$nonincent[1]
affiliate_Score_2i$ExpRev <- ExpRev_clean$expected_revenue[2]
affiliate_Score_2i$ExpRev2 <- ExpRev2_clean$incent[2]
affiliate_Score_2n$ExpRev <- ExpRev_clean$expected_revenue[2]
affiliate_Score_2n$ExpRev2 <- ExpRev2_clean$nonincent[2]
affiliate_Score_3i$ExpRev <- ExpRev_clean$expected_revenue[3]
affiliate_Score_3i$ExpRev2 <- ExpRev2_clean$incent[3]
affiliate_Score_3n$ExpRev <- ExpRev_clean$expected_revenue[3]
affiliate_Score_3n$ExpRev2 <- ExpRev2_clean$nonincent[3]
affiliate_Score_4i$ExpRev <- ExpRev_clean$expected_revenue[4]
affiliate_Score_4i$ExpRev2 <- ExpRev2_clean$incent[4]
affiliate_Score_4n$ExpRev <- ExpRev_clean$expected_revenue[4]
affiliate_Score_4n$ExpRev2 <- ExpRev2_clean$nonincent[4]
affiliate_Score_5i$ExpRev <- ExpRev_clean$expected_revenue[5]
affiliate_Score_5i$ExpRev2 <- ExpRev2_clean$incent[5]
affiliate_Score_5n$ExpRev <- ExpRev_clean$expected_revenue[5]
affiliate_Score_5n$ExpRev2 <- ExpRev2_clean$nonincent[5]
affiliate_Score <- bind_rows(affiliate_Score_1i, affiliate_Score_2i, affiliate_Score_3i, affiliate_Score_4i, affiliate_Score_5i)
table(affiliate_Score$IncentType)
table(affiliate_Score$ExpRev, affiliate_Score$IncentType)
table(affiliate_Score$ExpRev2, affiliate_Score$IncentType)
affiliate_Score <- bind_cols(affiliate_list, data.frame(ExpRev = rep(0, nrow(affiliate_list))),
data.frame(ExpRev2 = rep(0, nrow(affiliate_list))))
## Avg.CreditScore (6)
## IncentType (9)
#scoreRanges <- c(100, 499, 500, 574, 575, 674, 675, 749, 750, 850)
#incent <- c("incent", "nonincent")
affiliate_Score_5i <- filter(affiliate_Score, Avg.CreditScore >= 100 & Avg.CreditScore <=499 & IncentType %in% "incent")
affiliate_Score_5n <- filter(affiliate_Score, Avg.CreditScore >= 100 & Avg.CreditScore <=499 & IncentType %in% "nonincent")
affiliate_Score_4i <- filter(affiliate_Score, Avg.CreditScore >= 500 & Avg.CreditScore <=574 & IncentType %in% "incent")
affiliate_Score_4n <- filter(affiliate_Score, Avg.CreditScore >= 500 & Avg.CreditScore <=574 & IncentType %in% "nonincent")
affiliate_Score_3i <- filter(affiliate_Score, Avg.CreditScore >= 575 & Avg.CreditScore <=674 & IncentType %in% "incent")
affiliate_Score_3n <- filter(affiliate_Score, Avg.CreditScore >= 575 & Avg.CreditScore <=674 & IncentType %in% "nonincent")
affiliate_Score_2i <- filter(affiliate_Score, Avg.CreditScore >= 675 & Avg.CreditScore <=749 & IncentType %in% "incent")
affiliate_Score_2n <- filter(affiliate_Score, Avg.CreditScore >= 675 & Avg.CreditScore <=749 & IncentType %in% "nonincent")
affiliate_Score_1i <- filter(affiliate_Score, Avg.CreditScore >= 750 & Avg.CreditScore <=850 & IncentType %in% "incent")
affiliate_Score_1n <- filter(affiliate_Score, Avg.CreditScore >= 750 & Avg.CreditScore <=850 & IncentType %in% "nonincent")
affiliate_Score_0 <- filter(affiliate_Score, Avg.CreditScore <100)
affiliate_Score_1i$ExpRev <- ExpRev_clean$expected_revenue[1]
affiliate_Score_1i$ExpRev2 <- ExpRev2_clean$incent[1]
affiliate_Score_1n$ExpRev <- ExpRev_clean$expected_revenue[1]
affiliate_Score_1n$ExpRev2 <- ExpRev2_clean$nonincent[1]
affiliate_Score_2i$ExpRev <- ExpRev_clean$expected_revenue[2]
affiliate_Score_2i$ExpRev2 <- ExpRev2_clean$incent[2]
affiliate_Score_2n$ExpRev <- ExpRev_clean$expected_revenue[2]
affiliate_Score_2n$ExpRev2 <- ExpRev2_clean$nonincent[2]
affiliate_Score_3i$ExpRev <- ExpRev_clean$expected_revenue[3]
affiliate_Score_3i$ExpRev2 <- ExpRev2_clean$incent[3]
affiliate_Score_3n$ExpRev <- ExpRev_clean$expected_revenue[3]
affiliate_Score_3n$ExpRev2 <- ExpRev2_clean$nonincent[3]
affiliate_Score_4i$ExpRev <- ExpRev_clean$expected_revenue[4]
affiliate_Score_4i$ExpRev2 <- ExpRev2_clean$incent[4]
affiliate_Score_4n$ExpRev <- ExpRev_clean$expected_revenue[4]
affiliate_Score_4n$ExpRev2 <- ExpRev2_clean$nonincent[4]
affiliate_Score_5i$ExpRev <- ExpRev_clean$expected_revenue[5]
affiliate_Score_5i$ExpRev2 <- ExpRev2_clean$incent[5]
affiliate_Score_5n$ExpRev <- ExpRev_clean$expected_revenue[5]
affiliate_Score_5n$ExpRev2 <- ExpRev2_clean$nonincent[5]
affiliate_Score <- bind_rows(affiliate_Score_1i, affiliate_Score_2i, affiliate_Score_3i, affiliate_Score_4i, affiliate_Score_5i,
affiliate_Score_1n, affiliate_Score_2n, affiliate_Score_3n, affiliate_Score_4n, affiliate_Score_5n,
affiliate_Score_0)
table(affiliate_Score$IncentType)
table(affiliate_Score$ExpRev, affiliate_Score$IncentType)
table(affiliate_Score$ExpRev2, affiliate_Score$IncentType)
table(affiliate_list$IncentType)
sum(is.na(affiliate_list$Avg.CreditScore))
sum((affiliate_list$Avg.CreditScore)>=0)
29492  +   45950  +   61429  +     916
nrow(affiliate_Score)
max(affiliate_Score$Avg.CreditScore)
nrow(filter(affiliate_Score$Avg.CreditScore >=100 & affiliate_Score$Avg.CreditScore<850))
nrow(filter(affiliate_Score, Avg.CreditScore >=100 & Avg.CreditScore<850))
nrow(filter(affiliate_list, Avg.CreditScore >=100 & Avg.CreditScore<850))
nrow(affiliate_Score_0)
affiliate_Score_0 <- filter(affiliate_Score, Avg.CreditScore <100 | !(IncentType %in% c("incent", "nonincent")))
nrow(affiliate_Score_0)
nrow(filter(affiliate_Score, Avg.CreditScore <100 | !(IncentType %in% c("incent", "nonincent"))))
nrow(filter(affiliate_Score, !(IncentType %in% c("incent", "nonincent"))))
nrow(filter(affiliate_Score, Avg.CreditScore <100))
nrow(filter(affiliate_Score, Avg.CreditScore <100 | IncentType %in% c("", "promo")))
affiliate_Score <- bind_cols(affiliate_list, data.frame(ExpRev = rep(0, nrow(affiliate_list))),
data.frame(ExpRev2 = rep(0, nrow(affiliate_list))))
## Avg.CreditScore (6)
## IncentType (9)
#scoreRanges <- c(100, 499, 500, 574, 575, 674, 675, 749, 750, 850)
#incent <- c("incent", "nonincent")
affiliate_Score_5i <- filter(affiliate_Score, Avg.CreditScore >= 100 & Avg.CreditScore <=499 & IncentType %in% "incent")
affiliate_Score_5n <- filter(affiliate_Score, Avg.CreditScore >= 100 & Avg.CreditScore <=499 & IncentType %in% "nonincent")
affiliate_Score_4i <- filter(affiliate_Score, Avg.CreditScore >= 500 & Avg.CreditScore <=574 & IncentType %in% "incent")
affiliate_Score_4n <- filter(affiliate_Score, Avg.CreditScore >= 500 & Avg.CreditScore <=574 & IncentType %in% "nonincent")
affiliate_Score_3i <- filter(affiliate_Score, Avg.CreditScore >= 575 & Avg.CreditScore <=674 & IncentType %in% "incent")
affiliate_Score_3n <- filter(affiliate_Score, Avg.CreditScore >= 575 & Avg.CreditScore <=674 & IncentType %in% "nonincent")
affiliate_Score_2i <- filter(affiliate_Score, Avg.CreditScore >= 675 & Avg.CreditScore <=749 & IncentType %in% "incent")
affiliate_Score_2n <- filter(affiliate_Score, Avg.CreditScore >= 675 & Avg.CreditScore <=749 & IncentType %in% "nonincent")
affiliate_Score_1i <- filter(affiliate_Score, Avg.CreditScore >= 750 & Avg.CreditScore <=850 & IncentType %in% "incent")
affiliate_Score_1n <- filter(affiliate_Score, Avg.CreditScore >= 750 & Avg.CreditScore <=850 & IncentType %in% "nonincent")
affiliate_Score_0 <- filter(affiliate_Score, Avg.CreditScore <100 | !(IncentType %in% c("incent", "nonincent")))
affiliate_Score_1i$ExpRev <- ExpRev_clean$expected_revenue[1]
affiliate_Score_1i$ExpRev2 <- ExpRev2_clean$incent[1]
affiliate_Score_1n$ExpRev <- ExpRev_clean$expected_revenue[1]
affiliate_Score_1n$ExpRev2 <- ExpRev2_clean$nonincent[1]
affiliate_Score_2i$ExpRev <- ExpRev_clean$expected_revenue[2]
affiliate_Score_2i$ExpRev2 <- ExpRev2_clean$incent[2]
affiliate_Score_2n$ExpRev <- ExpRev_clean$expected_revenue[2]
affiliate_Score_2n$ExpRev2 <- ExpRev2_clean$nonincent[2]
affiliate_Score_3i$ExpRev <- ExpRev_clean$expected_revenue[3]
affiliate_Score_3i$ExpRev2 <- ExpRev2_clean$incent[3]
affiliate_Score_3n$ExpRev <- ExpRev_clean$expected_revenue[3]
affiliate_Score_3n$ExpRev2 <- ExpRev2_clean$nonincent[3]
affiliate_Score_4i$ExpRev <- ExpRev_clean$expected_revenue[4]
affiliate_Score_4i$ExpRev2 <- ExpRev2_clean$incent[4]
affiliate_Score_4n$ExpRev <- ExpRev_clean$expected_revenue[4]
affiliate_Score_4n$ExpRev2 <- ExpRev2_clean$nonincent[4]
affiliate_Score_5i$ExpRev <- ExpRev_clean$expected_revenue[5]
affiliate_Score_5i$ExpRev2 <- ExpRev2_clean$incent[5]
affiliate_Score_5n$ExpRev <- ExpRev_clean$expected_revenue[5]
affiliate_Score_5n$ExpRev2 <- ExpRev2_clean$nonincent[5]
affiliate_Score <- bind_rows(affiliate_Score_1i, affiliate_Score_2i, affiliate_Score_3i, affiliate_Score_4i, affiliate_Score_5i,
affiliate_Score_1n, affiliate_Score_2n, affiliate_Score_3n, affiliate_Score_4n, affiliate_Score_5n,
affiliate_Score_0)
sum((affiliate_list$Avg.CreditScore)>=0)
table(affiliate_list$IncentType)
table(affiliate_Score$IncentType)
table(affiliate_Score$ExpRev, affiliate_Score$IncentType)
table(affiliate_Score$ExpRev2, affiliate_Score$IncentType)
ExpRev2_clean
ExpRev_clean
ExpRev2_clean$nonincent[1]
affiliate_Score2 <- bind_rows(affiliate_Score_1i, affiliate_Score_2i, affiliate_Score_3i, affiliate_Score_4i, affiliate_Score_5i,
affiliate_Score_1n, affiliate_Score_2n, affiliate_Score_3n, affiliate_Score_4n, affiliate_Score_5n,
affiliate_Score_0)
affiliateScore3_1_b4 <- filter(affiliateScore3, General.Sale..credit.report. == 1 & Date <= mdy("06/11/2015")
& IncentType %in% c("incent", "nonincent"))
affiliateScore3 <- cbind(affiliateScore2, Cost = rep(0, nrow(affiliateScore2)))
affiliate_Score3 <- cbind(affiliate_Score2, Cost = rep(0, nrow(affiliateScore2)))
affiliate_Score3 <- cbind(affiliate_Score2, Cost = rep(0, nrow(affiliate_Score2)))
affiliate_Score3_1_b4 <- filter(affiliate_Score3, General.Sale..credit.report. == 1 & Date <= mdy("06/11/2015")
& IncentType %in% c("incent", "nonincent"))
affiliate_Score3_0 <- filter(affiliate_Score3, General.Sale..credit.report. == 0, IncentType %in% c("incent", "nonincent"))
affiliate_Score3_1_b4 <- filter(affiliate_Score3, General.Sale..credit.report. == 1 & Date <= mdy("06/11/2015")
& IncentType %in% c("incent", "nonincent"))
affiliate_Score3_1_now_i <- filter(affiliate_Score3, General.Sale..credit.report. == 1 & Date > mdy("06/11/2015")
& IncentType == "incent")
affiliate_Score3_1_now_n <- filter(affiliate_Score3, General.Sale..credit.report. == 1 & Date > mdy("06/11/2015")
& IncentType == "nonincent")
affiliateScore3_1_b4$Cost <- 7
affiliateScore3_1_now_i$Cost <- 2
affiliateScore3_1_now_n$Cost <- 8
affiliateScore3_0$Cost <- 0
affiliate_Score3_1_b4$Cost <- 7
affiliate_Score3_1_now_i$Cost <- 2
affiliate_Score3_1_now_n$Cost <- 8
affiliate_Score3_0$Cost <- 0
table(affiliate_Score3_1_b4$Cost) + table(affiliateScore_3_1_now_n$Cost) + table(affiliateScore_3_1_now_i$Cost)
+ table(affiliate_Score3_0$Cost)
table(affiliate_Score3_1_b4$Cost) + table(affiliate_Score3_1_now_n$Cost) + table(affiliate_Score3_1_now_i$Cost)
+ table(affiliate_Score3_0$Cost)
table(affiliate_Score3_1_b4$Cost)
table(affiliate_Score3_1_now_n$Cost)
table(affiliate_Score3_1_now_i$Cost)
table(affiliate_Score3_0$Cost)
table(affiliate_Score3_1_b4$Cost) + table(affiliate_Score3_1_now_n$Cost) + table(affiliate_Score3_1_now_i$Cost) + table(affiliate_Score3_0$Cost)
table(affiliate_Score3_1_b4$Cost)[1]
nrow(affiliate_Score3_1_b4$Cost)[1] + nrow(affiliate_Score3_1_now_n$Cost) + nrow(affiliate_Score3_1_now_i$Cost) + nrow(affiliate_Score3_0$Cost)
nrow(affiliate_Score3_1_b4$Cost) + nrow(affiliate_Score3_1_now_n$Cost) + nrow(affiliate_Score3_1_now_i$Cost) + nrow(affiliate_Score3_0$Cost)
nrow(affiliate_Score3_1_b4$Cost)
nrow(affiliate_Score3_1_b4$Cost)
nrow(affiliate_Score3_1_b4) + nrow(affiliate_Score3_1_now_n) + nrow(affiliate_Score3_1_now_i) + nrow(affiliate_Score3_0)
nrow(affiliate_Score2)
affiliate_Score3_00 <- filter(affiliateScore3, !(IncentType %in% c("incent", "nonincent")))
affiliate_Score3_00 <- filter(affiliate_Score3, !(IncentType %in% c("incent", "nonincent")))
affiliate_Score3_0 <- filter(affiliate_Score3, General.Sale..credit.report. == 0, IncentType %in% c("incent", "nonincent"))
names(affiliate_Score3)
affiliate_Score3 <- cbind(affiliate_Score2, Cost = rep(0, nrow(affiliate_Score2)))
affiliate_Score3_0 <- filter(affiliate_Score3, General.Sale..credit.report. == 0, IncentType %in% c("incent", "nonincent"))
affiliate_Score3_1_b4 <- filter(affiliate_Score3, General.Sale..credit.report. == 1 & Date <= mdy("06/11/2015")
& IncentType %in% c("incent", "nonincent"))
affiliate_Score3_1_now_i <- filter(affiliate_Score3, General.Sale..credit.report. == 1 & Date > mdy("06/11/2015")
& IncentType == "incent")
affiliate_Score3_1_now_n <- filter(affiliate_Score3, General.Sale..credit.report. == 1 & Date > mdy("06/11/2015")
& IncentType == "nonincent")
affiliate_Score3_00 <- filter(affiliate_Score3, !(IncentType %in% c("incent", "nonincent")))
affiliate_Score3_1_b4$Cost <- 7
affiliate_Score3_1_now_i$Cost <- 2
affiliate_Score3_1_now_n$Cost <- 8
affiliate_Score3_0$Cost <- 0
affiliate_Score3_00$Cost <- 0
affiliate_Score3 <- cbind(affiliate_Score2, Cost = rep(0, nrow(affiliate_Score2)))
head(affiliate_Score3$IncentType)
affiliate_Score3_0 <- filter(affiliate_Score3, General.Sale..credit.report. == 0, IncentType %in% c("incent", "nonincent"))
affiliate_Score3 <- cbind(affiliate_Score2, Cost = rep(0, nrow(affiliate_Score2)))
names(affiliate_Score3)
affiliate_Score3_0 <- filter(affiliate_Score3, General.Sale..credit.report. == 0, IncentType %in% c("incent", "nonincent"))
affiliate_Score3_0 <- filter(affiliate_Score3, General.Sale..credit.report. == 0 & IncentType %in% c("incent", "nonincent"))
head(affiliate_Score3$General.Sale..credit.report. == 0)
affiliate_Score3_0 <- filter(affiliate_Score3, General.Sale..credit.report. == 0)
class(affiliate_Score3$General.Sale..credit.report.)
affiliate_Score3_0 <- filter(affiliate_Score3, IncentType %in% c("incent", "nonincent"))
affiliate_Score3_1_b4 <- filter(affiliate_Score3, General.Sale..credit.report. == 1 & Date <= mdy("06/11/2015")
& IncentType %in% c("incent", "nonincent"))
table(affiliate_list$IncentType)
table(affiliate_list$General.Sale..credit.report.)
table(affiliate_Score3$General.Sale..credit.report.)
test <- filter(affiliate_Score3, General.Sale..credit.report. == 1)
library(dplyr)
library(lubridate)
affiliate_Score3_0 <- filter(affiliate_Score3, General.Sale..credit.report. == 0 & IncentType %in% c("incent", "nonincent"))
affiliate_Score3_1_b4 <- filter(affiliate_Score3, General.Sale..credit.report. == 1 & Date <= mdy("06/11/2015")
& IncentType %in% c("incent", "nonincent"))
affiliate_Score3_1_now_i <- filter(affiliate_Score3, General.Sale..credit.report. == 1 & Date > mdy("06/11/2015")
& IncentType == "incent")
affiliate_Score3_1_now_n <- filter(affiliate_Score3, General.Sale..credit.report. == 1 & Date > mdy("06/11/2015")
& IncentType == "nonincent")
affiliate_Score3_00 <- filter(affiliate_Score3, !(IncentType %in% c("incent", "nonincent")))
affiliate_Score3_1_b4$Cost <- 7
affiliate_Score3_1_now_i$Cost <- 2
affiliate_Score3_1_now_n$Cost <- 8
affiliate_Score3_0$Cost <- 0
affiliate_Score3_00$Cost <- 0
affiliate_Score3_1_b4$Cost <- 7
affiliate_Score3_1_b4 <- filter(affiliate_Score3, General.Sale..credit.report. == 1 & Date <= mdy("06/11/2015")
& IncentType %in% c("incent", "nonincent"))
affiliate_Score3_1_b4$Cost <- 7
table(affiliate_Score3_1_b4$Cost)
table(affiliate_Score3_1_b4$Cost)[1] + table(affiliate_Score3_1_now_n$Cost) + table(affiliate_Score3_1_now_i$Cost) + table(affiliate_Score3_0$Cost)
nrow(affiliate_Score2)
nrow(affiliate_Score3_1_b4) + nrow(affiliate_Score3_1_now_n) + nrow(affiliate_Score3_1_now_i) + nrow(affiliate_Score3_0)
nrow(affiliate_Score3)
nrow(affiliate_Score3_1_b4)
nrow(affiliate_Score3_1_b4) + nrow(affiliate_Score3_1_now_n) + nrow(affiliate_Score3_1_now_i) + nrow(affiliate_Score3_0) + nrow(affiliate_Score3_00)
affiliateScore4 <- bind_rows(affiliate_Score3_1_b4, affiliate_Score3_1_now_i, affiliate_Score3_1_now_n, affiliate_Score3_0, affiliate_Score3_00)
nrow(affiliateScore4)
aFinal_all <- summarise(group_by(affiliateScore4, Partner.Name_clean, IncentType), "Total Clicks" = sum(Click, na.rm = TRUE), "Total Cost" = sum(Cost, na.rm = TRUE))
## ONLY W/ SCORE    Number_Registered =  n(), sum(ExpRev)
aFinal_reg <- summarise(group_by(filter(affiliateScore4, General.Sale..credit.report. == 1), Partner.Name_clean, IncentType),
"Number Registered" = n(), "Total ExpRev" = sum(ExpRev, na.rm = TRUE))
## ONLY NO SCORE    Number_Incomplete_Registration = n()
aFinal_nonReg <- summarise(group_by(filter(affiliateScore4, General.Sale..credit.report. == 0), Partner.Name_clean, IncentType),
"Number Incomplete Registration" = n())
## Stats about the score
aFinal_reg_score <- summarise(group_by(filter(affiliateScore4, General.Sale..credit.report. == 1 & Avg.CreditScore >=100), Partner.Name_clean, IncentType),
"Min Score" = min(Avg.CreditScore), "Max Score" = max(Avg.CreditScore),	"Avg Score" = mean(Avg.CreditScore), "Median Score" = median(Avg.CreditScore))
aFinal_all_reg <- left_join(aFinal_all, aFinal_reg, by = c("Partner.Name_clean", "IncentType"))
aFinal_all_reg_nonReg <- left_join(aFinal_all_reg, aFinal_nonReg, by = c("Partner.Name_clean", "IncentType"))
aFinal_final_all <- left_join(aFinal_all_reg_nonReg, aFinal_reg_score, by = c("Partner.Name_clean", "IncentType"))
aFinal_final_all <- mutate(aFinal_final_all, "Avg CPA" = `Total Cost`/`Number Registered`,
"Click to Registration Rate" = `Total Clicks`/`Number Registered`,
"Avg ExpRev by Registered" = `Total ExpRev`/`Number Registered`,
"ROI" = `Total ExpRev`/`Total Cost`,
"Ratio Incomplete Registration vs. Complete Registration (smaller is better)" = `Number Incomplete Registration`/`Number Registered`)
zFinal <- aFinal_final_all[,c(1,2,3,4,12,5,13,6,14,15,7,16,8,9,10,11)]
View(arrange(as.data.frame(filter(zFinal, IncentType %in% c("incent", "nonincent"))), IncentType, desc(`Number Registered`)))
aFinal_reg <- summarise(group_by(filter(affiliateScore4, General.Sale..credit.report. == 1), Partner.Name_clean, IncentType),
"Number Registered" = n(), "Total ExpRev" = sum(ExpRev, na.rm = TRUE), "Total ExpRev2" = sum(ExpRev2, na.rm = TRUE))
aFinal_all_reg <- left_join(aFinal_all, aFinal_reg, by = c("Partner.Name_clean", "IncentType"))
aFinal_all_reg_nonReg <- left_join(aFinal_all_reg, aFinal_nonReg, by = c("Partner.Name_clean", "IncentType"))
aFinal_final_all <- left_join(aFinal_all_reg_nonReg, aFinal_reg_score, by = c("Partner.Name_clean", "IncentType"))
aFinal_final_all <- mutate(aFinal_final_all, "Avg CPA" = `Total Cost`/`Number Registered`,
"Click to Registration Rate" = `Total Clicks`/`Number Registered`,
"Avg ExpRev by Registered" = `Total ExpRev`/`Number Registered`,
"ROI" = `Total ExpRev`/`Total Cost`,
"Ratio Incomplete Registration vs. Complete Registration (smaller is better)" = `Number Incomplete Registration`/`Number Registered`)
names(aFinal_final_all)
zFinal <- aFinal_final_all[,c(1,2,3,4,13,5,14,6,7,15,16,8,17,9,10,11,12)]
View(arrange(as.data.frame(filter(zFinal, IncentType %in% c("incent", "nonincent"))), IncentType, desc(`Number Registered`)))
aFinal_final_all <- mutate(aFinal_final_all, "Avg CPA" = `Total Cost`/`Number Registered`,
"Click to Registration Rate" = `Total Clicks`/`Number Registered`,
"Avg ExpRev by Registered" = `Total ExpRev`/`Number Registered`,
"Avg ExpRev by Registered2" = `Total ExpRev2`/`Number Registered`,
"ROI" = `Total ExpRev`/`Total Cost`,
"ROI2" = `Total ExpRev2`/`Total Cost`,
"Ratio Incomplete Registration vs. Complete Registration (smaller is better)" = `Number Incomplete Registration`/`Number Registered`)
names(aFinal_final_all)
aFinal_final_all <- mutate(aFinal_final_all, "Avg CPA" = `Total Cost`/`Number Registered`,
"Click to Registration Rate" = `Total Clicks`/`Number Registered`,
"Avg ExpRev by Registered" = `Total ExpRev`/`Number Registered`,
"Avg ExpRev by Registered2" = `Total ExpRev2`/`Number Registered`,
"Exp ROI" = `Total ExpRev`/`Total Cost`,
"Exp ROI2" = `Total ExpRev2`/`Total Cost`,
"Ratio Incomplete Registration vs. Complete Registration (smaller is better)" = `Number Incomplete Registration`/`Number Registered`)
zFinal <- aFinal_final_all[,c(1,2,3,4,13,5,14,6,15,16,7,18,19,8,17,9,10,11,12)]
View(arrange(as.data.frame(filter(zFinal, IncentType %in% c("incent", "nonincent"))), IncentType, desc(`Number Registered`)))
View(ExpRev_clean)
View(ExpRev2_clean)
